import{a as fe,m as b,v as C,o as k,d as N,e as g,x as T,f as y,z as de,i as V,h as d,A as W,B as X,C as ne,r as ue,D as _e,t as M,w as B,E as ge,y as G,F as he,G as F,j as $,n as q}from"../chunks/scheduler.C3Y-C8ae.js";import{S as pe,i as me,t as j,c as ie,a as H,g as ce,b as ve,d as be,m as ke,e as we}from"../chunks/index.8appqJBc.js";import{m as Y,g as Ie}from"../chunks/util.bEHLoHXH.js";import{e as J,u as Se,o as ye}from"../chunks/each.D-IMo3H5.js";import{g as Ee}from"../chunks/entry.cTiwhmPW.js";import{g as Ne}from"../chunks/stores.DGv3dct_.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.BjtTzdTZ.js";import{G as xe}from"../chunks/gradeText.BXSl2-qM.js";const{Map:ze}=Ie;function Z(i,e,l){const t=i.slice();return t[11]=e[l],t[10]=l,t}function ee(i,e,l){const t=i.slice();return t[8]=e[l],t[10]=l,t}function te(i,e,l){const t=i.slice();return t[13]=e[l],t[10]=l,t}function se(i){let e,l="- current";return{c(){e=b("span"),e.textContent=l},l(t){e=k(t,"SPAN",{"data-svelte-h":!0}),F(e)!=="svelte-1xiodio"&&(e.textContent=l)},m(t,a){V(t,e,a)},d(t){t&&g(e)}}}function le(i){let e,l=i[13].name+"",t,a,n,s=i[10]===i[1]&&se();return{c(){e=b("option"),t=M(l),a=C(),s&&s.c(),n=C(),this.h()},l(r){e=k(r,"OPTION",{});var o=N(e);t=B(o,l),a=T(o),s&&s.l(o),n=T(o),o.forEach(g),this.h()},h(){e.__value=i[10],ge(e,e.__value)},m(r,o){V(r,e,o),d(e,t),d(e,a),s&&s.m(e,null),d(e,n)},p(r,o){o&1&&l!==(l=r[13].name+"")&&G(t,l),r[10]===r[1]?s||(s=se(),s.c(),s.m(e,n)):s&&(s.d(1),s=null)},d(r){r&&g(e),s&&s.d()}}}function Ce(i){let e=[],l=new ze,t,a,n=J(i[0].classes);const s=r=>r[10];for(let r=0;r<n.length;r+=1){let o=Z(i,n,r),p=s(o);l.set(p,e[r]=re(p,o))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=$()},l(r){for(let o=0;o<e.length;o+=1)e[o].l(r);t=$()},m(r,o){for(let p=0;p<e.length;p+=1)e[p]&&e[p].m(r,o);V(r,t,o),a=!0},p(r,o){o&1&&(n=J(r[0].classes),ce(),e=Se(e,o,s,1,r,n,l,t.parentNode,ye,re,t,Z),ie())},i(r){if(!a){for(let o=0;o<n.length;o+=1)H(e[o]);a=!0}},o(r){for(let o=0;o<e.length;o+=1)j(e[o]);a=!1},d(r){r&&g(t);for(let o=0;o<e.length;o+=1)e[o].d(r)}}}function Te(i){let e,l=J({length:i[0].classes.length==0?7:i[0].classes.length}),t=[];for(let a=0;a<l.length;a+=1)t[a]=ae(ee(i,l,a));return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=$()},l(a){for(let n=0;n<t.length;n+=1)t[n].l(a);e=$()},m(a,n){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(a,n);V(a,e,n)},p(a,n){if(n&1){l=J({length:a[0].classes.length==0?7:a[0].classes.length});let s;for(s=0;s<l.length;s+=1){const r=ee(a,l,s);t[s]?t[s].p(r,n):(t[s]=ae(),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},i:q,o:q,d(a){a&&g(e),ne(t,a)}}}function Ve(i){let e=i[11].grade+"",l,t,a=i[11].letter_grade+"",n;return{c(){l=M(e),t=M("% - "),n=M(a)},l(s){l=B(s,e),t=B(s,"% - "),n=B(s,a)},m(s,r){V(s,l,r),V(s,t,r),V(s,n,r)},p(s,r){r&1&&e!==(e=s[11].grade+"")&&G(l,e),r&1&&a!==(a=s[11].letter_grade+"")&&G(n,a)},d(s){s&&(g(l),g(t),g(n))}}}function re(i,e){let l,t,a,n=oe(e[11].name)+"",s,r,o,p,S,x=e[11].teacher+"",w,f,v,h,A,c,m,_,u,D="View",L,R,O;return h=new xe({props:{style:"text-3xl bg-gradient-to-t",grade:Y(e[11].letter_grade),$$slots:{default:[Ve]},$$scope:{ctx:e}}}),{key:i,first:null,c(){l=b("div"),t=b("div"),a=b("span"),s=M(n),r=C(),o=b("br"),p=C(),S=b("span"),w=M(x),f=C(),v=b("div"),ve(h.$$.fragment),A=C(),c=b("br"),m=C(),_=b("a"),u=b("button"),u.textContent=D,R=C(),this.h()},l(E){l=k(E,"DIV",{class:!0});var I=N(l);t=k(I,"DIV",{class:!0});var z=N(t);a=k(z,"SPAN",{class:!0});var U=N(a);s=B(U,n),U.forEach(g),r=T(z),o=k(z,"BR",{}),p=T(z),S=k(z,"SPAN",{class:!0});var K=N(S);w=B(K,x),K.forEach(g),z.forEach(g),f=T(I),v=k(I,"DIV",{class:!0});var P=N(v);be(h.$$.fragment,P),A=T(P),c=k(P,"BR",{}),m=T(P),_=k(P,"A",{href:!0});var Q=N(_);u=k(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),F(u)!=="svelte-1x6mmyt"&&(u.textContent=D),Q.forEach(g),P.forEach(g),R=T(I),I.forEach(g),this.h()},h(){y(a,"class","text-xl"),y(S,"class","text-l"),y(t,"class","flex50 block pl-3 svelte-1e6zu7p"),y(u,"class","btn bg-gradient-to-br variant-gradient-primary-tertiary mr-2 mt-2"),y(_,"href",L="/classView/"+e[10]),y(v,"class","flex50 block pr-3 text-right svelte-1e6zu7p"),y(l,"class","card gradecard p-1 svelte-1e6zu7p"),this.first=l},m(E,I){V(E,l,I),d(l,t),d(t,a),d(a,s),d(t,r),d(t,o),d(t,p),d(t,S),d(S,w),d(l,f),d(l,v),ke(h,v,null),d(v,A),d(v,c),d(v,m),d(v,_),d(_,u),d(l,R),O=!0},p(E,I){e=E,(!O||I&1)&&n!==(n=oe(e[11].name)+"")&&G(s,n),(!O||I&1)&&x!==(x=e[11].teacher+"")&&G(w,x);const z={};I&1&&(z.grade=Y(e[11].letter_grade)),I&32769&&(z.$$scope={dirty:I,ctx:e}),h.$set(z),(!O||I&1&&L!==(L="/classView/"+e[10]))&&y(_,"href",L)},i(E){O||(H(h.$$.fragment,E),O=!0)},o(E){j(h.$$.fragment,E),O=!1},d(E){E&&g(l),we(h)}}}function ae(i){let e,l='<div class="flex50 block pl-3 pt-1 svelte-1e6zu7p"><div class="h-2.5 rounded-lg bg-gray-700 w-24 md:w-48"></div> <br/> <div class="h-2.5 rounded-lg bg-gray-600 w-16 md:w-32"></div></div> <div class="flex50 pr-3 pt-1 flex items-end flex-col svelte-1e6zu7p"><div class="h-2.5 rounded-lg bg-gray-700 w-28 md:w-48"></div> <br/> <div class="h-5 rounded-lg bg-gray-600 w-20 mr-2 mt-2 md:w-30"></div></div> ';return{c(){e=b("div"),e.innerHTML=l,this.h()},l(t){e=k(t,"DIV",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-sbkri4"&&(e.innerHTML=l),this.h()},h(){y(e,"class","card gradecard placeholder animate-pulse p-2 svelte-1e6zu7p")},m(t,a){V(t,e,a)},p:q,d(t){t&&g(e)}}}function De(i){let e,l,t,a,n,s,r,o,p,S,x,w=J(i[0].reporting_periods),f=[];for(let c=0;c<w.length;c+=1)f[c]=le(te(i,w,c));const v=[Te,Ce],h=[];function A(c,m){return c[3]?0:1}return r=A(i),o=h[r]=v[r](i),{c(){e=b("div"),l=b("div"),t=b("div"),a=C(),n=b("select");for(let c=0;c<f.length;c+=1)f[c].c();s=C(),o.c(),this.h()},l(c){e=k(c,"DIV",{class:!0});var m=N(e);l=k(m,"DIV",{class:!0});var _=N(l);t=k(_,"DIV",{}),N(t).forEach(g),a=T(_),n=k(_,"SELECT",{class:!0});var u=N(n);for(let D=0;D<f.length;D+=1)f[D].l(u);u.forEach(g),_.forEach(g),s=T(m),o.l(m),m.forEach(g),this.h()},h(){y(n,"class","select variant-ghost-primary selector justify-self-end mr-5 svelte-1e6zu7p"),i[2]===void 0&&de(()=>i[5].call(n)),y(l,"class","grid grid-cols-2 w-4/5"),y(e,"class","container")},m(c,m){V(c,e,m),d(e,l),d(l,t),d(l,a),d(l,n);for(let _=0;_<f.length;_+=1)f[_]&&f[_].m(n,null);W(n,i[2],!0),d(e,s),h[r].m(e,null),p=!0,S||(x=[X(n,"change",i[5]),X(n,"change",i[4])],S=!0)},p(c,[m]){if(m&3){w=J(c[0].reporting_periods);let u;for(u=0;u<w.length;u+=1){const D=te(c,w,u);f[u]?f[u].p(D,m):(f[u]=le(D),f[u].c(),f[u].m(n,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=w.length}m&4&&W(n,c[2]);let _=r;r=A(c),r===_?h[r].p(c,m):(ce(),j(h[_],1,1,()=>{h[_]=null}),ie(),o=h[r],o?o.p(c,m):(o=h[r]=v[r](c),o.c()),H(o,1),o.m(e,null))},i(c){p||(H(o),p=!0)},o(c){j(o),p=!1},d(c){c&&g(e),ne(f,c),h[r].d(),S=!1,ue(x)}}}function oe(i){return i.split("(")[0].trim()}function Oe(i,e,l){const t=Ne();let a={classes:[],report_period:0,reporting_periods:[]},n=0,s,r=new Map,o=!1;async function p(){var v;if(r.has(s)){l(0,a=r.get(s)),sessionStorage.setItem("data",JSON.stringify(a));return}l(3,o=!0);const x={method:"POST",headers:{"Accept-Encoding":"br",Authorization:`Bearer ${(v=r.get(n))==null?void 0:v.token}`}},w=await fetch(`https://worker-rust.zillorz.workers.dev/grades/${s}`,x);let f=await w.text();if(w.status!=200){const h={message:`Error loading ${a.reporting_periods[s].name}: ${f}`,background:"variant-filled-error bg-gradient-to-r from-error-400 to-error-600",timeout:3e3};throw l(0,a=r.get(n)),l(3,o=!1),l(2,s=n),t.trigger(h),new Error(f)}l(0,a=JSON.parse(f)),l(3,o=!1),sessionStorage.setItem("data",f),r.set(s,a)}_e(async()=>{(sessionStorage.getItem("data")===null||Number.parseInt(sessionStorage.getItem("expiry")??"0")<Date.now())&&await Ee("/"),l(0,a=JSON.parse(sessionStorage.getItem("data"))),sessionStorage.getItem("cidx")===null?sessionStorage.setItem("cidx",""+a.report_period):Number.parseInt(sessionStorage.getItem("cidx"))!=a.report_period&&r.set(Number.parseInt(sessionStorage.getItem("cidx")),JSON.parse(sessionStorage.getItem("cdata"))),l(1,n=Number.parseInt(sessionStorage.getItem("cidx"))),l(2,s=a.report_period),r.set(s,a)});function S(){s=he(this),l(2,s)}return[a,n,s,o,p,S]}class je extends pe{constructor(e){super(),me(this,e,Oe,De,fe,{})}}export{je as component};
