import{s as ue,e as m,D as V,c as v,a as $,d as p,F as D,b as y,M as pe,i as O,g as _,W as X,J as Q,T as ne,B as he,U as me,C as B,E as R,I as ve,G,X as be,H as W,q as H,n as U}from"../chunks/scheduler.CxubwLq2.js";import{S as ke,i as Ie,b as ie,d as ce,m as fe,t as q,c as de,a as F,e as _e,g as ge}from"../chunks/index.D9ug8rk0.js";import{g as Se}from"../chunks/globals.D0QH3NT1.js";import{e as L,u as we,o as ye}from"../chunks/each.BY6V-KCU.js";import{g as Ee}from"../chunks/entry.Cs-YgNc9.js";import{W as Ne}from"../chunks/main.D8RZwWgc.js";import{g as xe}from"../chunks/stores.Bj6dW65N.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.DH4BMg8D.js";import{G as $e}from"../chunks/gradeText.DJ9cw9D1.js";import{m as Y}from"../chunks/util.BWaUixtN.js";import{P as Ce}from"../chunks/pageSelector.CjfgKNAI.js";const{Map:Te}=Se;function Z(i,e,l){const s=i.slice();return s[11]=e[l],s[10]=l,s}function ee(i,e,l){const s=i.slice();return s[8]=e[l],s[10]=l,s}function te(i,e,l){const s=i.slice();return s[13]=e[l],s[10]=l,s}function se(i){let e,l="- current";return{c(){e=m("span"),e.textContent=l},l(s){e=v(s,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-1xiodio"&&(e.textContent=l)},m(s,r){O(s,e,r)},d(s){s&&p(e)}}}function le(i){let e,l=i[13].name+"",s,r,n,t=i[10]===i[1]&&se();return{c(){e=m("option"),s=B(l),r=V(),t&&t.c(),n=V(),this.h()},l(a){e=v(a,"OPTION",{});var o=$(e);s=R(o,l),r=D(o),t&&t.l(o),n=D(o),o.forEach(p),this.h()},h(){e.__value=i[10],ve(e,e.__value)},m(a,o){O(a,e,o),_(e,s),_(e,r),t&&t.m(e,null),_(e,n)},p(a,o){o&1&&l!==(l=a[13].name+"")&&G(s,l),a[10]===a[1]?t||(t=se(),t.c(),t.m(e,n)):t&&(t.d(1),t=null)},d(a){a&&p(e),t&&t.d()}}}function Ve(i){let e=[],l=new Te,s,r,n=L(i[0].classes);const t=a=>a[10];for(let a=0;a<n.length;a+=1){let o=Z(i,n,a),d=t(o);l.set(d,e[a]=re(d,o))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();s=H()},l(a){for(let o=0;o<e.length;o+=1)e[o].l(a);s=H()},m(a,o){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(a,o);O(a,s,o),r=!0},p(a,o){o&1&&(n=L(a[0].classes),ge(),e=we(e,o,t,1,a,n,l,s.parentNode,ye,re,s,Z),de())},i(a){if(!r){for(let o=0;o<n.length;o+=1)F(e[o]);r=!0}},o(a){for(let o=0;o<e.length;o+=1)q(e[o]);r=!1},d(a){a&&p(s);for(let o=0;o<e.length;o+=1)e[o].d(a)}}}function De(i){let e,l=L({length:i[0].classes.length==0?7:i[0].classes.length}),s=[];for(let r=0;r<l.length;r+=1)s[r]=ae(ee(i,l,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=H()},l(r){for(let n=0;n<s.length;n+=1)s[n].l(r);e=H()},m(r,n){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(r,n);O(r,e,n)},p(r,n){if(n&1){l=L({length:r[0].classes.length==0?7:r[0].classes.length});let t;for(t=0;t<l.length;t+=1){const a=ee(r,l,t);s[t]?s[t].p(a,n):(s[t]=ae(),s[t].c(),s[t].m(e.parentNode,e))}for(;t<s.length;t+=1)s[t].d(1);s.length=l.length}},i:U,o:U,d(r){r&&p(e),ne(s,r)}}}function Oe(i){let e=i[11].grade.toFixed(2)+"",l,s,r=i[11].letter_grade+"",n;return{c(){l=B(e),s=B("% - "),n=B(r)},l(t){l=R(t,e),s=R(t,"% - "),n=R(t,r)},m(t,a){O(t,l,a),O(t,s,a),O(t,n,a)},p(t,a){a&1&&e!==(e=t[11].grade.toFixed(2)+"")&&G(l,e),a&1&&r!==(r=t[11].letter_grade+"")&&G(n,r)},d(t){t&&(p(l),p(s),p(n))}}}function re(i,e){let l,s,r,n=oe(e[11].name)+"",t,a,o,d,k,E=e[11].teacher+"",I,S,f,N,w,A,c,g,u,h="View",C,P,M;return N=new $e({props:{style:"text-3xl bg-gradient-to-t",grade:Y(e[11].letter_grade),$$slots:{default:[Oe]},$$scope:{ctx:e}}}),{key:i,first:null,c(){l=m("div"),s=m("div"),r=m("span"),t=B(n),a=V(),o=m("br"),d=V(),k=m("span"),I=B(E),S=V(),f=m("div"),ie(N.$$.fragment),w=V(),A=m("br"),c=V(),g=m("a"),u=m("button"),u.textContent=h,P=V(),this.h()},l(x){l=v(x,"DIV",{class:!0});var b=$(l);s=v(b,"DIV",{class:!0});var T=$(s);r=v(T,"SPAN",{class:!0});var j=$(r);t=R(j,n),j.forEach(p),a=D(T),o=v(T,"BR",{}),d=D(T),k=v(T,"SPAN",{class:!0});var z=$(k);I=R(z,E),z.forEach(p),T.forEach(p),S=D(b),f=v(b,"DIV",{class:!0});var J=$(f);ce(N.$$.fragment,J),w=D(J),A=v(J,"BR",{}),c=D(J),g=v(J,"A",{href:!0});var K=$(g);u=v(K,"BUTTON",{class:!0,"data-svelte-h":!0}),W(u)!=="svelte-15htl23"&&(u.textContent=h),K.forEach(p),J.forEach(p),P=D(b),b.forEach(p),this.h()},h(){y(r,"class","text-xl"),y(k,"class","text-l"),y(s,"class","flex50 block pl-3 svelte-spalkl"),y(u,"class","btn bg-gradient-to-br variant-gradient-primary-tertiary mr-2 mt-2"),y(g,"href",C="/classView/"+e[10]),y(f,"class","flex50 block pr-3 text-right svelte-spalkl"),y(l,"class","card gradecard p-1 svelte-spalkl"),this.first=l},m(x,b){O(x,l,b),_(l,s),_(s,r),_(r,t),_(s,a),_(s,o),_(s,d),_(s,k),_(k,I),_(l,S),_(l,f),fe(N,f,null),_(f,w),_(f,A),_(f,c),_(f,g),_(g,u),_(l,P),M=!0},p(x,b){e=x,(!M||b&1)&&n!==(n=oe(e[11].name)+"")&&G(t,n),(!M||b&1)&&E!==(E=e[11].teacher+"")&&G(I,E);const T={};b&1&&(T.grade=Y(e[11].letter_grade)),b&32769&&(T.$$scope={dirty:b,ctx:e}),N.$set(T),(!M||b&1&&C!==(C="/classView/"+e[10]))&&y(g,"href",C)},i(x){M||(F(N.$$.fragment,x),M=!0)},o(x){q(N.$$.fragment,x),M=!1},d(x){x&&p(l),_e(N)}}}function ae(i){let e,l='<div class="flex50 block pl-3 pt-1 svelte-spalkl"><div class="h-2.5 rounded-lg bg-gray-700 w-24 md:w-48"></div> <br/> <div class="h-2.5 rounded-lg bg-gray-600 w-16 md:w-32"></div></div> <div class="flex50 pr-3 pt-1 flex items-end flex-col svelte-spalkl"><div class="h-2.5 rounded-lg bg-gray-700 w-28 md:w-48"></div> <br/> <div class="h-5 rounded-lg bg-gray-600 w-20 mr-2 mt-2 md:w-30"></div></div> ';return{c(){e=m("div"),e.innerHTML=l,this.h()},l(s){e=v(s,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1q98nla"&&(e.innerHTML=l),this.h()},h(){y(e,"class","card gradecard placeholder animate-pulse p-2 svelte-spalkl")},m(s,r){O(s,e,r)},p:U,d(s){s&&p(e)}}}function Pe(i){let e,l,s,r,n,t,a,o,d,k,E,I;r=new Ce({props:{classes:"select variant-ghost-primary",selected:"grades"}});let S=L(i[0].reporting_periods),f=[];for(let c=0;c<S.length;c+=1)f[c]=le(te(i,S,c));const N=[De,Ve],w=[];function A(c,g){return c[3]?0:1}return o=A(i),d=w[o]=N[o](i),{c(){e=m("div"),l=m("div"),s=m("div"),ie(r.$$.fragment),n=V(),t=m("select");for(let c=0;c<f.length;c+=1)f[c].c();a=V(),d.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var g=$(e);l=v(g,"DIV",{class:!0});var u=$(l);s=v(u,"DIV",{});var h=$(s);ce(r.$$.fragment,h),h.forEach(p),n=D(u),t=v(u,"SELECT",{class:!0});var C=$(t);for(let P=0;P<f.length;P+=1)f[P].l(C);C.forEach(p),u.forEach(p),a=D(g),d.l(g),g.forEach(p),this.h()},h(){y(t,"class","select variant-ghost-primary selector justify-self-end svelte-spalkl"),i[2]===void 0&&pe(()=>i[5].call(t)),y(l,"class","grid grid-cols-2 w-4/5"),y(e,"class","container")},m(c,g){O(c,e,g),_(e,l),_(l,s),fe(r,s,null),_(l,n),_(l,t);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(t,null);X(t,i[2],!0),_(e,a),w[o].m(e,null),k=!0,E||(I=[Q(t,"change",i[5]),Q(t,"change",i[4])],E=!0)},p(c,[g]){if(g&3){S=L(c[0].reporting_periods);let h;for(h=0;h<S.length;h+=1){const C=te(c,S,h);f[h]?f[h].p(C,g):(f[h]=le(C),f[h].c(),f[h].m(t,null))}for(;h<f.length;h+=1)f[h].d(1);f.length=S.length}g&4&&X(t,c[2]);let u=o;o=A(c),o===u?w[o].p(c,g):(ge(),q(w[u],1,1,()=>{w[u]=null}),de(),d=w[o],d?d.p(c,g):(d=w[o]=N[o](c),d.c()),F(d,1),d.m(e,null))},i(c){k||(F(r.$$.fragment,c),F(d),k=!0)},o(c){q(r.$$.fragment,c),q(d),k=!1},d(c){c&&p(e),_e(r),ne(f,c),w[o].d(),E=!1,he(I)}}}function oe(i){return i.split("(")[0].trim()}function Me(i,e,l){const s=xe();let r={classes:[],report_period:0,reporting_periods:[]},n=0,t,a=new Map,o=!1;async function d(){if(a.has(t)){l(0,r=a.get(t)),sessionStorage.setItem("data",JSON.stringify(r));return}l(3,o=!0);const E={headers:{"Accept-Encoding":"br",Authorization:`Bearer ${sessionStorage.getItem("token")}`}},I=await fetch(`${Ne}/grades?report_period=${t}`,E);if(I.headers.has("set-token")&&sessionStorage.setItem("token",I.headers.get("set-token")),I.status!=200){let S=await I.text();const f={message:`Error loading ${r.reporting_periods[t].name}: ${S}`,background:"variant-filled-error bg-gradient-to-r from-error-400 to-error-600",timeout:3e3};throw l(0,r=a.get(n)),l(3,o=!1),l(2,t=n),s.trigger(f),new Error(S)}l(0,r=JSON.parse(await I.text())),l(3,o=!1),sessionStorage.setItem("data",JSON.stringify(r)),a.set(t,r)}me(async()=>{(sessionStorage.getItem("data")===null||Number.parseInt(sessionStorage.getItem("expiry")??"0")<Date.now())&&await Ee("/"),l(0,r=JSON.parse(sessionStorage.getItem("data"))),sessionStorage.getItem("cidx")===null?sessionStorage.setItem("cidx",""+r.report_period):Number.parseInt(sessionStorage.getItem("cidx"))!=r.report_period&&a.set(Number.parseInt(sessionStorage.getItem("cidx")),JSON.parse(sessionStorage.getItem("cdata"))),l(1,n=Number.parseInt(sessionStorage.getItem("cidx"))),l(2,t=r.report_period),a.set(t,r)});function k(){t=be(this),l(2,t)}return[r,n,t,o,d,k]}class je extends ke{constructor(e){super(),Ie(this,e,Me,Pe,ue,{})}}export{je as component};
