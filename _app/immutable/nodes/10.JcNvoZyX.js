import{s as ge,e as m,l as C,c as v,a as $,d as p,m as P,b as S,P as pe,i as D,g as _,Q,q as X,M as ne,I as he,o as me,t as J,p as R,J as ve,r as F,T as be,k as W,y as G,n as H}from"../chunks/scheduler.BhNCGW4c.js";import{S as ke,i as Ie,b as ie,d as ce,m as fe,t as q,c as de,a as U,e as _e,g as ue}from"../chunks/index.By4zub_x.js";import{g as we}from"../chunks/globals.D0QH3NT1.js";import{e as L,u as Se,o as ye}from"../chunks/each.CYVRkUBn.js";import{g as Ee}from"../chunks/entry.C8l_-luy.js";import{W as Ne}from"../chunks/main.DlQOQXQP.js";import{g as xe}from"../chunks/stores.Bs2cUqnn.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.BXlGj4x9.js";import{G as $e}from"../chunks/gradeText.DqNMQO6V.js";import{m as Y}from"../chunks/util.UZ_QSrM9.js";import{P as Te}from"../chunks/pageSelector.UFOusoNK.js";import{u as Ve}from"../chunks/pack.CTx6hWTx.js";const{Map:Ce}=we;function Z(i,e,l){const s=i.slice();return s[11]=e[l],s[10]=l,s}function ee(i,e,l){const s=i.slice();return s[8]=e[l],s[10]=l,s}function te(i,e,l){const s=i.slice();return s[13]=e[l],s[10]=l,s}function se(i){let e,l="- current";return{c(){e=m("span"),e.textContent=l},l(s){e=v(s,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-1xiodio"&&(e.textContent=l)},m(s,r){D(s,e,r)},d(s){s&&p(e)}}}function le(i){let e,l=i[13].name+"",s,r,n,t=i[10]===i[1]&&se();return{c(){e=m("option"),s=J(l),r=C(),t&&t.c(),n=C(),this.h()},l(a){e=v(a,"OPTION",{});var o=$(e);s=R(o,l),r=P(o),t&&t.l(o),n=P(o),o.forEach(p),this.h()},h(){e.__value=i[10],ve(e,e.__value)},m(a,o){D(a,e,o),_(e,s),_(e,r),t&&t.m(e,null),_(e,n)},p(a,o){o&1&&l!==(l=a[13].name+"")&&F(s,l),a[10]===a[1]?t||(t=se(),t.c(),t.m(e,n)):t&&(t.d(1),t=null)},d(a){a&&p(e),t&&t.d()}}}function Pe(i){let e=[],l=new Ce,s,r,n=L(i[0].classes);const t=a=>a[10];for(let a=0;a<n.length;a+=1){let o=Z(i,n,a),d=t(o);l.set(d,e[a]=re(d,o))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();s=G()},l(a){for(let o=0;o<e.length;o+=1)e[o].l(a);s=G()},m(a,o){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(a,o);D(a,s,o),r=!0},p(a,o){o&1&&(n=L(a[0].classes),ue(),e=Se(e,o,t,1,a,n,l,s.parentNode,ye,re,s,Z),de())},i(a){if(!r){for(let o=0;o<n.length;o+=1)U(e[o]);r=!0}},o(a){for(let o=0;o<e.length;o+=1)q(e[o]);r=!1},d(a){a&&p(s);for(let o=0;o<e.length;o+=1)e[o].d(a)}}}function De(i){let e,l=L({length:i[0].classes.length==0?7:i[0].classes.length}),s=[];for(let r=0;r<l.length;r+=1)s[r]=ae(ee(i,l,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=G()},l(r){for(let n=0;n<s.length;n+=1)s[n].l(r);e=G()},m(r,n){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(r,n);D(r,e,n)},p(r,n){if(n&1){l=L({length:r[0].classes.length==0?7:r[0].classes.length});let t;for(t=0;t<l.length;t+=1){const a=ee(r,l,t);s[t]?s[t].p(a,n):(s[t]=ae(),s[t].c(),s[t].m(e.parentNode,e))}for(;t<s.length;t+=1)s[t].d(1);s.length=l.length}},i:H,o:H,d(r){r&&p(e),ne(s,r)}}}function Oe(i){let e=i[11].grade.toFixed(2)+"",l,s,r=i[11].letter_grade+"",n;return{c(){l=J(e),s=J("% - "),n=J(r)},l(t){l=R(t,e),s=R(t,"% - "),n=R(t,r)},m(t,a){D(t,l,a),D(t,s,a),D(t,n,a)},p(t,a){a&1&&e!==(e=t[11].grade.toFixed(2)+"")&&F(l,e),a&1&&r!==(r=t[11].letter_grade+"")&&F(n,r)},d(t){t&&(p(l),p(s),p(n))}}}function re(i,e){let l,s,r,n=oe(e[11].name)+"",t,a,o,d,k,y=e[11].teacher+"",E,I,f,N,w,M,c,u,g,h="View",T,O,A;return N=new $e({props:{style:"text-3xl bg-gradient-to-t",grade:Y(e[11].letter_grade),$$slots:{default:[Oe]},$$scope:{ctx:e}}}),{key:i,first:null,c(){l=m("div"),s=m("div"),r=m("span"),t=J(n),a=C(),o=m("br"),d=C(),k=m("span"),E=J(y),I=C(),f=m("div"),ie(N.$$.fragment),w=C(),M=m("br"),c=C(),u=m("a"),g=m("button"),g.textContent=h,O=C(),this.h()},l(x){l=v(x,"DIV",{class:!0});var b=$(l);s=v(b,"DIV",{class:!0});var V=$(s);r=v(V,"SPAN",{class:!0});var j=$(r);t=R(j,n),j.forEach(p),a=P(V),o=v(V,"BR",{}),d=P(V),k=v(V,"SPAN",{class:!0});var z=$(k);E=R(z,y),z.forEach(p),V.forEach(p),I=P(b),f=v(b,"DIV",{class:!0});var B=$(f);ce(N.$$.fragment,B),w=P(B),M=v(B,"BR",{}),c=P(B),u=v(B,"A",{href:!0});var K=$(u);g=v(K,"BUTTON",{class:!0,"data-svelte-h":!0}),W(g)!=="svelte-15htl23"&&(g.textContent=h),K.forEach(p),B.forEach(p),O=P(b),b.forEach(p),this.h()},h(){S(r,"class","text-xl"),S(k,"class","text-l"),S(s,"class","flex50 block pl-3 svelte-spalkl"),S(g,"class","btn bg-gradient-to-br variant-gradient-primary-tertiary mr-2 mt-2"),S(u,"href",T="/classView/"+e[10]),S(f,"class","flex50 block pr-3 text-right svelte-spalkl"),S(l,"class","card gradecard p-1 svelte-spalkl"),this.first=l},m(x,b){D(x,l,b),_(l,s),_(s,r),_(r,t),_(s,a),_(s,o),_(s,d),_(s,k),_(k,E),_(l,I),_(l,f),fe(N,f,null),_(f,w),_(f,M),_(f,c),_(f,u),_(u,g),_(l,O),A=!0},p(x,b){e=x,(!A||b&1)&&n!==(n=oe(e[11].name)+"")&&F(t,n),(!A||b&1)&&y!==(y=e[11].teacher+"")&&F(E,y);const V={};b&1&&(V.grade=Y(e[11].letter_grade)),b&32769&&(V.$$scope={dirty:b,ctx:e}),N.$set(V),(!A||b&1&&T!==(T="/classView/"+e[10]))&&S(u,"href",T)},i(x){A||(U(N.$$.fragment,x),A=!0)},o(x){q(N.$$.fragment,x),A=!1},d(x){x&&p(l),_e(N)}}}function ae(i){let e,l='<div class="flex50 block pl-3 pt-1 svelte-spalkl"><div class="h-2.5 rounded-lg bg-gray-700 w-24 md:w-48"></div> <br/> <div class="h-2.5 rounded-lg bg-gray-600 w-16 md:w-32"></div></div> <div class="flex50 pr-3 pt-1 flex items-end flex-col svelte-spalkl"><div class="h-2.5 rounded-lg bg-gray-700 w-28 md:w-48"></div> <br/> <div class="h-5 rounded-lg bg-gray-600 w-20 mr-2 mt-2 md:w-30"></div></div> ';return{c(){e=m("div"),e.innerHTML=l,this.h()},l(s){e=v(s,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1q98nla"&&(e.innerHTML=l),this.h()},h(){S(e,"class","card gradecard placeholder animate-pulse p-2 svelte-spalkl")},m(s,r){D(s,e,r)},p:H,d(s){s&&p(e)}}}function Ae(i){let e,l,s,r,n,t,a,o,d,k,y,E;r=new Te({props:{classes:"select variant-ghost-primary",selected:"grades"}});let I=L(i[0].reporting_periods),f=[];for(let c=0;c<I.length;c+=1)f[c]=le(te(i,I,c));const N=[De,Pe],w=[];function M(c,u){return c[3]?0:1}return o=M(i),d=w[o]=N[o](i),{c(){e=m("div"),l=m("div"),s=m("div"),ie(r.$$.fragment),n=C(),t=m("select");for(let c=0;c<f.length;c+=1)f[c].c();a=C(),d.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var u=$(e);l=v(u,"DIV",{class:!0});var g=$(l);s=v(g,"DIV",{});var h=$(s);ce(r.$$.fragment,h),h.forEach(p),n=P(g),t=v(g,"SELECT",{class:!0});var T=$(t);for(let O=0;O<f.length;O+=1)f[O].l(T);T.forEach(p),g.forEach(p),a=P(u),d.l(u),u.forEach(p),this.h()},h(){S(t,"class","select variant-ghost-primary selector justify-self-end svelte-spalkl"),i[2]===void 0&&pe(()=>i[5].call(t)),S(l,"class","grid grid-cols-2 w-4/5"),S(e,"class","container")},m(c,u){D(c,e,u),_(e,l),_(l,s),fe(r,s,null),_(l,n),_(l,t);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(t,null);Q(t,i[2],!0),_(e,a),w[o].m(e,null),k=!0,y||(E=[X(t,"change",i[5]),X(t,"change",i[4])],y=!0)},p(c,[u]){if(u&3){I=L(c[0].reporting_periods);let h;for(h=0;h<I.length;h+=1){const T=te(c,I,h);f[h]?f[h].p(T,u):(f[h]=le(T),f[h].c(),f[h].m(t,null))}for(;h<f.length;h+=1)f[h].d(1);f.length=I.length}u&4&&Q(t,c[2]);let g=o;o=M(c),o===g?w[o].p(c,u):(ue(),q(w[g],1,1,()=>{w[g]=null}),de(),d=w[o],d?d.p(c,u):(d=w[o]=N[o](c),d.c()),U(d,1),d.m(e,null))},i(c){k||(U(r.$$.fragment,c),U(d),k=!0)},o(c){q(r.$$.fragment,c),q(d),k=!1},d(c){c&&p(e),_e(r),ne(f,c),w[o].d(),y=!1,he(E)}}}function oe(i){return i.split("(")[0].trim()}function Me(i,e,l){const s=xe();let r={classes:[],report_period:0,reporting_periods:[]},n=0,t,a=new Map,o=!1;async function d(){if(a.has(t)){l(0,r=a.get(t)),sessionStorage.setItem("data",JSON.stringify(r));return}l(3,o=!0);const y={headers:{"Accept-Encoding":"br",Authorization:`Bearer ${sessionStorage.getItem("token")}`}},E=await fetch(`${Ne}/grades/${t}`,y);if(E.status!=200){let I=await E.text();const f={message:`Error loading ${r.reporting_periods[t].name}: ${I}`,background:"variant-filled-error bg-gradient-to-r from-error-400 to-error-600",timeout:3e3};throw l(0,r=a.get(n)),l(3,o=!1),l(2,t=n),s.trigger(f),new Error(I)}l(0,r=Ve(new Uint8Array(await E.arrayBuffer()))),l(3,o=!1),sessionStorage.setItem("data",JSON.stringify(r)),a.set(t,r)}me(async()=>{(sessionStorage.getItem("data")===null||Number.parseInt(sessionStorage.getItem("expiry")??"0")<Date.now())&&await Ee("/"),l(0,r=JSON.parse(sessionStorage.getItem("data"))),sessionStorage.getItem("cidx")===null?sessionStorage.setItem("cidx",""+r.report_period):Number.parseInt(sessionStorage.getItem("cidx"))!=r.report_period&&a.set(Number.parseInt(sessionStorage.getItem("cidx")),JSON.parse(sessionStorage.getItem("cdata"))),l(1,n=Number.parseInt(sessionStorage.getItem("cidx"))),l(2,t=r.report_period),a.set(t,r)});function k(){t=be(this),l(2,t)}return[r,n,t,o,d,k]}class Ke extends ke{constructor(e){super(),Ie(this,e,Me,Ae,ge,{})}}export{Ke as component};
