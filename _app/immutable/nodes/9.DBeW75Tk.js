import{s as ge,e as m,E as V,c as v,a as $,d as p,G as D,b as S,P as pe,i as P,g as u,Q,J as X,M as ne,C as he,o as me,D as B,F as J,I as ve,H as G,T as be,k as W,r as H,n as U}from"../chunks/scheduler.HaoJMjUf.js";import{S as ke,i as Ie,b as ie,d as ce,m as fe,t as L,c as de,a as F,e as ue,g as _e}from"../chunks/index.G81k-Xhd.js";import{g as we}from"../chunks/globals.D0QH3NT1.js";import{e as R,u as Se,o as ye}from"../chunks/each.BvinSC2D.js";import{g as Ee}from"../chunks/entry.CY06v9jW.js";import{W as Ne}from"../chunks/main.DlQOQXQP.js";import{g as xe}from"../chunks/stores.6eYr0iPl.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.F8mDr4Rg.js";import{G as $e}from"../chunks/gradeText.0XH_dBwp.js";import{m as Y}from"../chunks/util.UZ_QSrM9.js";import{P as Ce}from"../chunks/pageSelector.CIVgMxR1.js";import{u as Te}from"../chunks/pack.CQ5w_lID.js";const{Map:Ve}=we;function Z(i,e,r){const s=i.slice();return s[11]=e[r],s[10]=r,s}function ee(i,e,r){const s=i.slice();return s[8]=e[r],s[10]=r,s}function te(i,e,r){const s=i.slice();return s[13]=e[r],s[10]=r,s}function se(i){let e,r="- current";return{c(){e=m("span"),e.textContent=r},l(s){e=v(s,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-1xiodio"&&(e.textContent=r)},m(s,l){P(s,e,l)},d(s){s&&p(e)}}}function re(i){let e,r=i[13].name+"",s,l,n,t=i[10]===i[1]&&se();return{c(){e=m("option"),s=B(r),l=V(),t&&t.c(),n=V(),this.h()},l(a){e=v(a,"OPTION",{});var o=$(e);s=J(o,r),l=D(o),t&&t.l(o),n=D(o),o.forEach(p),this.h()},h(){e.__value=i[10],ve(e,e.__value)},m(a,o){P(a,e,o),u(e,s),u(e,l),t&&t.m(e,null),u(e,n)},p(a,o){o&1&&r!==(r=a[13].name+"")&&G(s,r),a[10]===a[1]?t||(t=se(),t.c(),t.m(e,n)):t&&(t.d(1),t=null)},d(a){a&&p(e),t&&t.d()}}}function De(i){let e=[],r=new Ve,s,l,n=R(i[0].classes);const t=a=>a[10];for(let a=0;a<n.length;a+=1){let o=Z(i,n,a),d=t(o);r.set(d,e[a]=le(d,o))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();s=H()},l(a){for(let o=0;o<e.length;o+=1)e[o].l(a);s=H()},m(a,o){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(a,o);P(a,s,o),l=!0},p(a,o){o&1&&(n=R(a[0].classes),_e(),e=Se(e,o,t,1,a,n,r,s.parentNode,ye,le,s,Z),de())},i(a){if(!l){for(let o=0;o<n.length;o+=1)F(e[o]);l=!0}},o(a){for(let o=0;o<e.length;o+=1)L(e[o]);l=!1},d(a){a&&p(s);for(let o=0;o<e.length;o+=1)e[o].d(a)}}}function Pe(i){let e,r=R({length:i[0].classes.length==0?7:i[0].classes.length}),s=[];for(let l=0;l<r.length;l+=1)s[l]=ae(ee(i,r,l));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=H()},l(l){for(let n=0;n<s.length;n+=1)s[n].l(l);e=H()},m(l,n){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(l,n);P(l,e,n)},p(l,n){if(n&1){r=R({length:l[0].classes.length==0?7:l[0].classes.length});let t;for(t=0;t<r.length;t+=1){const a=ee(l,r,t);s[t]?s[t].p(a,n):(s[t]=ae(),s[t].c(),s[t].m(e.parentNode,e))}for(;t<s.length;t+=1)s[t].d(1);s.length=r.length}},i:U,o:U,d(l){l&&p(e),ne(s,l)}}}function ze(i){let e=i[11].grade.toFixed(2)+"",r,s,l=i[11].letter_grade+"",n;return{c(){r=B(e),s=B("% - "),n=B(l)},l(t){r=J(t,e),s=J(t,"% - "),n=J(t,l)},m(t,a){P(t,r,a),P(t,s,a),P(t,n,a)},p(t,a){a&1&&e!==(e=t[11].grade.toFixed(2)+"")&&G(r,e),a&1&&l!==(l=t[11].letter_grade+"")&&G(n,l)},d(t){t&&(p(r),p(s),p(n))}}}function le(i,e){let r,s,l,n=oe(e[11].name)+"",t,a,o,d,k,y=e[11].teacher+"",E,I,f,N,w,A,c,_,g,h="View",C,z,O;return N=new $e({props:{style:"text-3xl bg-gradient-to-t",grade:Y(e[11].letter_grade),$$slots:{default:[ze]},$$scope:{ctx:e}}}),{key:i,first:null,c(){r=m("div"),s=m("div"),l=m("span"),t=B(n),a=V(),o=m("br"),d=V(),k=m("span"),E=B(y),I=V(),f=m("div"),ie(N.$$.fragment),w=V(),A=m("br"),c=V(),_=m("a"),g=m("button"),g.textContent=h,z=V(),this.h()},l(x){r=v(x,"DIV",{class:!0});var b=$(r);s=v(b,"DIV",{class:!0});var T=$(s);l=v(T,"SPAN",{class:!0});var j=$(l);t=J(j,n),j.forEach(p),a=D(T),o=v(T,"BR",{}),d=D(T),k=v(T,"SPAN",{class:!0});var q=$(k);E=J(q,y),q.forEach(p),T.forEach(p),I=D(b),f=v(b,"DIV",{class:!0});var M=$(f);ce(N.$$.fragment,M),w=D(M),A=v(M,"BR",{}),c=D(M),_=v(M,"A",{href:!0});var K=$(_);g=v(K,"BUTTON",{class:!0,"data-svelte-h":!0}),W(g)!=="svelte-1x6mmyt"&&(g.textContent=h),K.forEach(p),M.forEach(p),z=D(b),b.forEach(p),this.h()},h(){S(l,"class","text-xl"),S(k,"class","text-l"),S(s,"class","flex50 block pl-3 svelte-1e6zu7p"),S(g,"class","btn bg-gradient-to-br variant-gradient-primary-tertiary mr-2 mt-2"),S(_,"href",C="/classView/"+e[10]),S(f,"class","flex50 block pr-3 text-right svelte-1e6zu7p"),S(r,"class","card gradecard p-1 svelte-1e6zu7p"),this.first=r},m(x,b){P(x,r,b),u(r,s),u(s,l),u(l,t),u(s,a),u(s,o),u(s,d),u(s,k),u(k,E),u(r,I),u(r,f),fe(N,f,null),u(f,w),u(f,A),u(f,c),u(f,_),u(_,g),u(r,z),O=!0},p(x,b){e=x,(!O||b&1)&&n!==(n=oe(e[11].name)+"")&&G(t,n),(!O||b&1)&&y!==(y=e[11].teacher+"")&&G(E,y);const T={};b&1&&(T.grade=Y(e[11].letter_grade)),b&32769&&(T.$$scope={dirty:b,ctx:e}),N.$set(T),(!O||b&1&&C!==(C="/classView/"+e[10]))&&S(_,"href",C)},i(x){O||(F(N.$$.fragment,x),O=!0)},o(x){L(N.$$.fragment,x),O=!1},d(x){x&&p(r),ue(N)}}}function ae(i){let e,r='<div class="flex50 block pl-3 pt-1 svelte-1e6zu7p"><div class="h-2.5 rounded-lg bg-gray-700 w-24 md:w-48"></div> <br/> <div class="h-2.5 rounded-lg bg-gray-600 w-16 md:w-32"></div></div> <div class="flex50 pr-3 pt-1 flex items-end flex-col svelte-1e6zu7p"><div class="h-2.5 rounded-lg bg-gray-700 w-28 md:w-48"></div> <br/> <div class="h-5 rounded-lg bg-gray-600 w-20 mr-2 mt-2 md:w-30"></div></div> ';return{c(){e=m("div"),e.innerHTML=r,this.h()},l(s){e=v(s,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-sbkri4"&&(e.innerHTML=r),this.h()},h(){S(e,"class","card gradecard placeholder animate-pulse p-2 svelte-1e6zu7p")},m(s,l){P(s,e,l)},p:U,d(s){s&&p(e)}}}function Oe(i){let e,r,s,l,n,t,a,o,d,k,y,E;l=new Ce({props:{classes:"select variant-ghost-primary",selected:"grades"}});let I=R(i[0].reporting_periods),f=[];for(let c=0;c<I.length;c+=1)f[c]=re(te(i,I,c));const N=[Pe,De],w=[];function A(c,_){return c[3]?0:1}return o=A(i),d=w[o]=N[o](i),{c(){e=m("div"),r=m("div"),s=m("div"),ie(l.$$.fragment),n=V(),t=m("select");for(let c=0;c<f.length;c+=1)f[c].c();a=V(),d.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var _=$(e);r=v(_,"DIV",{class:!0});var g=$(r);s=v(g,"DIV",{});var h=$(s);ce(l.$$.fragment,h),h.forEach(p),n=D(g),t=v(g,"SELECT",{class:!0});var C=$(t);for(let z=0;z<f.length;z+=1)f[z].l(C);C.forEach(p),g.forEach(p),a=D(_),d.l(_),_.forEach(p),this.h()},h(){S(t,"class","select variant-ghost-primary selector justify-self-end svelte-1e6zu7p"),i[2]===void 0&&pe(()=>i[5].call(t)),S(r,"class","grid grid-cols-2 w-4/5"),S(e,"class","container")},m(c,_){P(c,e,_),u(e,r),u(r,s),fe(l,s,null),u(r,n),u(r,t);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(t,null);Q(t,i[2],!0),u(e,a),w[o].m(e,null),k=!0,y||(E=[X(t,"change",i[5]),X(t,"change",i[4])],y=!0)},p(c,[_]){if(_&3){I=R(c[0].reporting_periods);let h;for(h=0;h<I.length;h+=1){const C=te(c,I,h);f[h]?f[h].p(C,_):(f[h]=re(C),f[h].c(),f[h].m(t,null))}for(;h<f.length;h+=1)f[h].d(1);f.length=I.length}_&4&&Q(t,c[2]);let g=o;o=A(c),o===g?w[o].p(c,_):(_e(),L(w[g],1,1,()=>{w[g]=null}),de(),d=w[o],d?d.p(c,_):(d=w[o]=N[o](c),d.c()),F(d,1),d.m(e,null))},i(c){k||(F(l.$$.fragment,c),F(d),k=!0)},o(c){L(l.$$.fragment,c),L(d),k=!1},d(c){c&&p(e),ue(l),ne(f,c),w[o].d(),y=!1,he(E)}}}function oe(i){return i.split("(")[0].trim()}function Ae(i,e,r){const s=xe();let l={classes:[],report_period:0,reporting_periods:[]},n=0,t,a=new Map,o=!1;async function d(){if(a.has(t)){r(0,l=a.get(t)),sessionStorage.setItem("data",JSON.stringify(l));return}r(3,o=!0);const y={headers:{"Accept-Encoding":"br",Authorization:`Bearer ${sessionStorage.getItem("token")}`}},E=await fetch(`${Ne}/grades/${t}`,y);if(E.status!=200){let I=await E.text();const f={message:`Error loading ${l.reporting_periods[t].name}: ${I}`,background:"variant-filled-error bg-gradient-to-r from-error-400 to-error-600",timeout:3e3};throw r(0,l=a.get(n)),r(3,o=!1),r(2,t=n),s.trigger(f),new Error(I)}r(0,l=Te(new Uint8Array(await E.arrayBuffer()))),r(3,o=!1),sessionStorage.setItem("data",JSON.stringify(l)),a.set(t,l)}me(async()=>{(sessionStorage.getItem("data")===null||Number.parseInt(sessionStorage.getItem("expiry")??"0")<Date.now())&&await Ee("/"),r(0,l=JSON.parse(sessionStorage.getItem("data"))),sessionStorage.getItem("cidx")===null?sessionStorage.setItem("cidx",""+l.report_period):Number.parseInt(sessionStorage.getItem("cidx"))!=l.report_period&&a.set(Number.parseInt(sessionStorage.getItem("cidx")),JSON.parse(sessionStorage.getItem("cdata"))),r(1,n=Number.parseInt(sessionStorage.getItem("cidx"))),r(2,t=l.report_period),a.set(t,l)});function k(){t=be(this),r(2,t)}return[l,n,t,o,d,k]}class Ke extends ke{constructor(e){super(),Ie(this,e,Ae,Oe,ge,{})}}export{Ke as component};
